
Процедура Инициализировать(Объект, ИмяТабличнойЧасти = Неопределено, ТабличноеПолеОбъекта = Неопределено) Экспорт
	
	//Объект[ИмяТабличнойЧасти].Очистить();
	
	СтандартнаяОбработка = Ложь;
	РежимДиалога =  РежимДиалогаВыбораФайла.Сохранение;
	ДиалогВыбораФайла = Новый ДиалогВыбораФайла(РежимДиалога);
	ДиалогВыбораФайла.ПроверятьСуществованиеФайла = Истина;
	ДиалогВыбораФайла.МножественныйВыбор = Ложь;
	ДиалогВыбораФайла.Заголовок = "Задайте имя файла выгрузки ТЧ";
	
	
	ДиалогВыбораФайла.Фильтр = "Формат выгрузки(*.xml)|*.xml|Все файлы (*.*)|*.*";
	
	Если ДиалогВыбораФайла.Выбрать() Тогда
		ИмяФайлаОтборов = ДиалогВыбораФайла.ПолноеИмяФайла;
	КонецЕсли;
	
	ТаблЗнач = Объект[ИмяТабличнойЧасти].Выгрузить();  
	
	ЗаписьXML = Новый ЗаписьXML;
    ЗаписьXML.ОткрытьФайл(ИмяФайлаОтборов);
    ЗаписьXML.ЗаписатьОбъявлениеXML();    
    ЗаписьXML.ЗаписатьНачалоЭлемента("Table");
	ЗаписьXML.ЗаписатьАтрибут("Ссылка", 		XMLСтрока(Объект.Ссылка.УникальныйИдентификатор()));
	ЗаписьXML.ЗаписатьАтрибут("ТабличнаяЧасть", XMLСтрока(ИмяТабличнойЧасти));
	
	Для Каждого строка Из ТаблЗнач Цикл
		
	    ЗаписьXML.ЗаписатьНачалоЭлемента("Row");
		Для Каждого колонка Из ТаблЗнач.Колонки Цикл
			Если строка[колонка.Имя]<>Неопределено Тогда
				ЗаписьXML.ЗаписатьНачалоЭлемента(колонка.Имя);
				ЗаписьXML.ЗаписатьАтрибут("type", XMLТипЗнч(строка[колонка.Имя]).ИмяТипа);
				ЗаписьXML.ЗаписатьАтрибут("value", XMLСтрока(строка[колонка.Имя]));
				ЗаписьXML.ЗаписатьКонецЭлемента(); // row
			КонецЕсли;
		КонецЦикла;	
		ЗаписьXML.ЗаписатьКонецЭлемента(); // row
		
	КонецЦикла;	
	
	ЗаписьXML.ЗаписатьКонецЭлемента(); // table
	ЗаписьXML.Закрыть();
	
	
КонецПроцедуры